====== fisherfaces in opencv ======

{{:blog:blog_fisherface.png?200 |}} 

**UPDATE NOTICE** This project is now included in libfacerec
  * //Repository// https://github.com/bytefish/libfacerec
  * //API// http://bytefish.de/dev/libfacerec/api/class/class_fisherfaces.html
  * //API Example// http://bytefish.de/dev/libfacerec/api/example/example_fisherfaces.html

I've found some minutes to implement the [[blog:fisherfaces|Fisherfaces method]] with [[http://opencv.willowgarage.com/wiki/|OpenCV2]]'s C++ API. The code has been pushed into my github repository at:

  * https://github.com/bytefish/opencv/tree/master/lda

As some kind of documentation, I am pasting the [[https://github.com/bytefish/opencv/blob/master/lda/README.markdown|README.markdown]] coming with the project. 

If you still have any troubles using it, just comment below or drop me a mail. 

===== github.com/bytefish/opencv/lda =====

This project implements the Fisherfaces method as described in: P. Belhumeur, J. Hespanha, and D. Kriegman, "Eigenfaces vs. Fisherfaces: Recognition Using Class Specific Linear Projection", IEEE Transactions on Pattern Analysis and Machine Intelligence, 19(7):711--720, 1997.

==== Building the Project ====

This project does not need any external libraries except [[http://opencv.willowgarage.com|OpenCV]], so compiling the project is as easy as writing (assuming you are in this folder):

<code>
philipp@mango:~/some/dir/lda$ mkdir build
philipp@mango:~/some/dir/lda$ cd build
philipp@mango:~/some/dir/lda/build$ cmake ..
philipp@mango:~/some/dir/lda/build$ make
philipp@mango:~/some/dir/lda/build$ ./lda filename.ext
</code>

And if you are in Windows using [[http://www.mingw.org|MinGW]] it may look like this:

<code>
C:\some\dir\lda> mkdir build
C:\some\dir\lda> cd build
C:\some\dir\lda\build> cmake -G "MinGW Makefiles" ..
C:\some\dir\lda\build> mingw32-make
C:\some\dir\lda\build> lda.exe filename.ext
</code>

You probably have to set the //OpenCV_DIR// variable if it wasn't added by your installation, see [[https://github.com/bytefish/opencv/blob/master/lda/CMakeLists.txt#L5|Line 5 in the CMakeLists.txt]] how to do this. If you have problems working with CMake or installing OpenCV, you probably want to read my guide on [[http://www.bytefish.de/blog/face_recognition_with_opencv2|Face Recognition with OpenCV2]]. 

==== Using the Project ====

The project comes with an example, please have a look at the [[https://github.com/bytefish/opencv/blob/master/lda/src/main.cpp|main.cpp]] on how to use the classes. You need some data to make the examples work, sorry but I really can't include those face databases in my repository. I have thoroughly commented the code and reworked it lately, to make its usage simpler. So if anything regarding the classes is unclear, please read the comments.

In the example I use a CSV file to read in the data, it's the easiest solution I can think of right now. However, if you know a simpler solution please ping me about it. Basically all the CSV file needs to contain are lines composed of a //filename// followed by a //;// followed by the //label// (as **integer number**), making up a line like this: ///path/to/image.ext;0//.

Think of the //label// as the subject (the person) this image belongs to, so same subjects (persons) should have the same //label//. An example CSV file for the [[http://www.cl.cam.ac.uk/research/dtg/attarchive/facedatabase.html|AT&T Facedatabase]] is [[https://github.com/bytefish/opencv/blob/master/eigenfaces/at.txt|given here]], which looks like this (assuming I've extracted the database to ///home/philipp/facerec/data/at//, file is without //...// of course):

<code>
/home/philipp/facerec/data/at/s1/1.pgm;0
/home/philipp/facerec/data/at/s1/2.pgm;0
...
/home/philipp/facerec/data/at/s2/1.pgm;1
/home/philipp/facerec/data/at/s2/2.pgm;1
...
/home/philipp/facerec/data/at/s40/1.pgm;39
/home/philipp/facerec/data/at/s40/2.pgm;39
</code>

Once you have a CSV file with **valid** //filenames// and //labels//, you can run the demo by simply starting the demo with the path to the CSV file as parameter:

<code>
./lda /path/to/your/csvfile.ext
</code>

Or if you are in Windows:

<code>
lda.exe /path/to/your/csvfile.ext
</code>

==== License ====

All code is put under a [[http://www.opensource.org/licenses/bsd-license|BSD license]], so feel free to use it for your projects.

{{tag>opencv cpp}}

~~DISCUSSION~~
